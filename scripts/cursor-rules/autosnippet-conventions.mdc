---
description: AutoSnippet conventions — Skills for semantics, MCP for capabilities; do not edit Knowledge directly
alwaysApply: true
---

# AutoSnippet Conventions

These rules are aligned with `.github/copilot-instructions.md` and jointly provide the AI with basic project cognition and required guardrails.

These rules are written when installing AutoSnippet Skills (`asd install:cursor-skill`) and should be followed in Cursor sessions.

## Semantics vs capabilities

- **Skills provide semantics**: When to use, workflows, and comparison with `asd ais` are described in Skills (e.g. autosnippet-when, autosnippet-batch-scan, autosnippet-recipes).
- **MCP provides capabilities**: Connection and tools are provided by MCP (`autosnippet_context_search`, `autosnippet_confirm_recipe_usage`, `autosnippet_open_create`, `autosnippet_get_targets`, `autosnippet_get_target_files`, `autosnippet_submit_candidates`). Do not hardcode URLs/HTTP in Skills.

## Project basics (for AI)

- **Project root**: directory containing `*.boxspec.json` (this repo: `AutoSnippet.boxspec.json`).
- **Knowledge base**: `Knowledge/` (read-only for AI).
- **Recipes**: `Knowledge/recipes/*.md` (Markdown + Frontmatter + Snippet/Usage Guide).
- **Snippets**: `Knowledge/snippets/*.json` or root spec `list`.
- **Candidates**: `Knowledge/.autosnippet/candidates.json` (reviewed in Dashboard).
- **Vector index**: `Knowledge/.autosnippet/context/` (`asd embed`).
- **Recipe stats**: `Knowledge/.autosnippet/recipe-stats.json` (usage + authority).
- **Weights**: `Knowledge/.autosnippet/recipe-stats-weights.json` or boxspec `recipes.statsWeights`.

## Knowledge base and submission

- **Do not edit** `Knowledge/recipes/` or `Knowledge/snippets/` directly; all Recipe/Snippet changes go through Dashboard and are saved after human review.
- **Search**: When you need Recipe/docs on demand, use MCP tool `autosnippet_context_search` (pass `query`, `limit?`) or read `.cursor/skills/autosnippet-recipes/references/project-recipes-context.md`. Search returns content only; it does not trigger any adoption form.
- **Retry policy**: If an MCP call fails, do not retry within the same agent turn; fall back to static docs or already-read context.
- **Adoption form**: Tool `autosnippet_confirm_recipe_usage` shows a “confirm use?” dialog. **Meaning**: On confirm, it records one human usage (humanUsageCount +1) for the recipe and affects usage stats and authority ranking. You may **decide when to show it** (e.g. when the user explicitly says they adopt, or when you infer they have adopted the recipe). Do not show it right after presenting a recipe or when the user only asks “should I adopt?”—then just answer. Pass the recipe file name(s) (e.g. from sourcePath basename).
- **Batch scan**: See Skill autosnippet-batch-scan; call `autosnippet_get_targets` → `autosnippet_get_target_files` → extract per file → `autosnippet_submit_candidates`.

## Recipe over code

When both a Recipe and the codebase have relevant implementations, prefer the Recipe. Recipes are the project’s agreed standard; source code may be legacy or non-standard.
