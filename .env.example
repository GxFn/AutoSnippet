# AutoSnippet 环境变量配置文件示例
#
# 使用方式：
#   1. 将本文件复制到「项目根目录」（即 AutoSnippet/AutoSnippet.boxspec.json 所在目录）
#   2. 重命名为 .env（注意没有 .example 后缀）
#   3. 根据下方说明填写 API Key 等配置
# 可从本仓库下载： https://github.com/GxFn/AutoSnippet/blob/main/.env.example
#
# 配置生效范围：asd ui、asd create、asd ais、asd watch 的 Guard、asd embed、asd search -m 等
# 会优先读取项目根目录下的 .env；未配置 API Key 时，上述依赖 AI 的功能会报错或提示。
#
# =============================================================================
# --- 0. 环境模式 (dev/prod) ---
# =============================================================================
# 开发模式: NODE_ENV=development, VITE_API_BASE_URL=http://localhost:3100
# 线上模式: NODE_ENV=production, VITE_API_BASE_URL=你的生产 API 地址
NODE_ENV=development
VITE_API_BASE_URL=http://localhost:3100

# 线上/开发差异字段集中管理
# 开发模式：ASD_SKIP_CHECKSUMS=1（跳过校验）
# 线上/发布：ASD_SKIP_CHECKSUMS=0（启用校验）
ASD_SKIP_CHECKSUMS=1

# =============================================================================
# --- 1. AI 提供商配置 ---
# =============================================================================
# 必填其一：根据所选提供商填写对应的 API Key；Ollama 本地 AI 通常不需要 Key。

# 当前使用的 AI 提供商
# 可选值: google, openai, deepseek, claude, ollama, mock
#   google   - Google Gemini，需填写 ASD_GOOGLE_API_KEY
#   openai  - OpenAI（含兼容接口），需填写 ASD_OPENAI_API_KEY
#   deepseek - DeepSeek，需填写 ASD_DEEPSEEK_API_KEY
#   claude  - Anthropic Claude，需填写 ASD_CLAUDE_API_KEY
#   ollama  - 本地 Ollama，默认 http://localhost:11434/v1，一般不需 Key
#   mock    - 模拟模式，用于测试，无真实请求
ASD_AI_PROVIDER=google

# 模型名称，根据上面 ASD_AI_PROVIDER 选择对应厂商的模型 ID
# 常用示例：
#   google:  gemini-2.0-flash, gemini-1.5-pro, gemini-1.5-flash
#   openai:  gpt-4o, gpt-4-turbo, gpt-4o-mini
#   deepseek: deepseek-chat, deepseek-coder
#   claude:  claude-3-5-sonnet-20240620, claude-3-opus-20240229
#   ollama:  llama3 (推荐), qwen2 (中文好), mistral, code-llama, neural-chat, orca-mini
ASD_AI_MODEL=gemini-2.0-flash

# 各提供商的 API Key（只填当前使用的提供商即可，其余可留空）
ASD_GOOGLE_API_KEY=
ASD_OPENAI_API_KEY=
ASD_DEEPSEEK_API_KEY=
ASD_CLAUDE_API_KEY=

# 自定义 API 地址（可选）
# 适用于：自建代理、国内镜像、或 Ollama 等本地服务不在默认端口时
# 未设置时使用各厂商官方默认地址
# ASD_OPENAI_BASE_URL=https://api.openai.com/v1
# ASD_DEEPSEEK_BASE_URL=https://api.deepseek.com/v1
# ASD_CLAUDE_BASE_URL=https://api.anthropic.com/v1
# ASD_OLLAMA_BASE_URL=http://127.0.0.1:11434/v1

# =============================================================================
# --- 2. 写权限探针（可选）---
# =============================================================================
# 启用后，保存/删除 Recipe、Snippet 前会在子仓库目录执行 git push --dry-run；
# 无 push 权限时返回 403，前端提示「没权限」及勿擅动核心代码。
# 未设置则不启用探针，行为与当前一致。

# 探针目录（相对项目根，即 submodule 在项目内的目录名），如 auth-data；勿填 GitHub 仓库名（如 BiliDemo-auth-data）
# ASD_RECIPES_WRITE_DIR=auth-data

# 探针通过后的缓存有效期（秒），此时间内不重复执行 git push --dry-run；默认 86400（24 小时）
# ASD_PROBE_TTL_SECONDS=86400

# Recipe 保存频率控制（按「项目根 + 客户端 IP」固定窗口限流，防止短时间内多次创建/保存 Recipe）
# ASD_RECIPE_SAVE_RATE_LIMIT：窗口内允许的最多保存次数；默认 20。设为 0 表示不限制。
# ASD_RECIPE_SAVE_RATE_WINDOW_SECONDS：时间窗口长度（秒）；默认 60。即「在 WINDOW_SECONDS 秒内最多保存 RATE_LIMIT 次」；设为 0 表示不限制。
# 示例：20 + 60 = 每分钟最多 20 次；10 + 300 = 每 5 分钟最多 10 次。超限返回 429，前端提示「保存过于频繁，请稍后再试」。
# ASD_RECIPE_SAVE_RATE_LIMIT=20
# ASD_RECIPE_SAVE_RATE_WINDOW_SECONDS=60

# 完整性校验入口：包内存在 checksums.json 时，直接运行 node bin/asnip.js 会警告；设 ASD_STRICT_ENTRY=1 则拒绝运行（必须用 asd 命令）
# ASD_SKIP_CHECKSUMS=1：开发/调试时跳过 checksums 校验，不需要频繁执行 generate-checksums.js
# ASD_SKIP_ENTRY_CHECK=1：不警告、不拒跑，开发/调试时可用
# ASD_STRICT_ENTRY=1：强制执行完整性校验，发布时推荐
# ASD_SKIP_CHECKSUMS=1
# ASD_SKIP_ENTRY_CHECK=0

# =============================================================================
# --- 3. Dashboard 与构建配置 ---
# =============================================================================

# 是否在启动 asd ui 时强制重新构建前端（0=否，1=是）
# 设为 1 时，每次 asd ui 都会先执行 npm run build:dashboard，适合本地改完 dashboard 代码后预览
# 正常使用保持 0 即可
ASD_UI_BUILD=0
ASD_UI_REBUILD=0

# =============================================================================
# --- 4. 监听与文件系统配置 ---
# =============================================================================

# 是否使用轮询方式监听文件变化（true / false）
# 默认 false 使用系统原生 watch；若项目在 NFS、网络盘或部分虚拟机上监听不生效，可改为 true
ASD_WATCH_POLLING=false

# Xcode Code Snippets 的存储路径（留空则使用默认）
# 默认: ~/Library/Developer/Xcode/UserData/CodeSnippets
# asd install 会把 Snippet 同步到此目录，Xcode 从这里加载
ASD_SNIPPETS_PATH=

# AutoSnippet 缓存目录（留空则使用默认）
# 用于缓存索引、临时数据等，一般无需修改
ASD_CACHE_PATH=

# 当工具发现「当前 Target 缺少对某模块的依赖」时，是否自动在 Package.swift 里插入依赖
# 典型场景：头文件注入（as:include）时，若当前 Target 的 dependencies 里没有对应模块，可自动补上
# 插入内容包含：同包内 .target 依赖、跨包 .product 依赖、以及 Package 级的 .package(path/url)
#
# ASD_FIX_SPM_DEPS：设为 1 或 true 时，启用自动插入（等价于 MODE=fix）
# ASD_FIX_SPM_DEPS_MODE：更细粒度控制，可选：
#   off    - 不自动改 Package.swift，仅给出修改建议（默认）
#   suggest - 同上，仅建议
#   fix    - 自动在 Package.swift 中插入缺失的 target/product/package 依赖
# 日常使用建议保持 off；确认需要自动补依赖时再改为 fix
ASD_FIX_SPM_DEPS=false
ASD_FIX_SPM_DEPS_MODE=

# =============================================================================
# --- 5. 开发与测试配置 ---
# =============================================================================
# 以下多为自动化测试或脚本调用时使用，日常使用可忽略。

# 预置输入 JSON 路径，用于非交互式 create 等（自动化/CI）
ASD_PRESET=
ASD_TEST_PRESET=

# 测试运行器使用的「模拟项目根目录」，默认指向 ../AutoSnippetTestHome/BiliDiliForTest
ASD_TEST_HOME=

# AI 提取时指定的源码文件路径（脚本/自动化用）
ASD_ACODE_FILE=

# 增量测试时传入的变更文件列表，供 test/runner.js --changed 使用
ASD_TEST_CHANGED_FILES=

# =============================================================================
# --- 6. 缓存与 Redis 配置（可选） ---
# =============================================================================
# API Server 缓存模式：memory（内存缓存，默认）或 redis（Redis 缓存）
# CACHE_MODE=memory

# Redis 连接配置（仅在 CACHE_MODE=redis 时需要）
# REDIS_HOST=localhost
# REDIS_PORT=6379
# REDIS_PASSWORD=
# REDIS_DB=0

# =============================================================================
# --- 7. 监控与性能配置（可选） ---
# =============================================================================
# 启用性能监控（默认开启）
# ENABLE_MONITORING=true

# 慢请求阈值（毫秒），超过此时间的请求会在日志中标记
# SLOW_REQUEST_THRESHOLD=1000

# WebSocket 服务器 URL（前端 Dashboard 使用）
# REACT_APP_WS_URL=http://localhost:3000

# API 请求日志（开发环境默认启用）
# LOG_REQUESTS=true

# 错误堆栈跟踪（开发环境默认显示）
# SHOW_ERROR_STACK=true

# =============================================================================
# --- 8. 网络代理（可选） ---
# =============================================================================
# 访问 Google / OpenAI 等 API 时走代理时设置；仅在有代理需求时取消注释并修改地址。

# ASD_OPENAI_PROXY_HTTP=http://127.0.0.1:7890
# ASD_OPENAI_PROXY_HTTPS=http://127.0.0.1:7890
# ASD_GOOGLE_PROXY_HTTP=http://127.0.0.1:7891
# ASD_GOOGLE_PROXY_HTTPS=http://127.0.0.1:7891
# ASD_DEEPSEEK_PROXY_HTTP=http://127.0.0.1:7892
# ASD_DEEPSEEK_PROXY_HTTPS=http://127.0.0.1:7892
# ASD_CLAUDE_PROXY_HTTP=http://127.0.0.1:7893
# ASD_CLAUDE_PROXY_HTTPS=http://127.0.0.1:7893
